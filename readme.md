PhileCMS Sub Navigation
=======================

A [PhileCMS](https://github.com/PhileCMS/Phile) plugin that generates a
hierarchy tree that can be used to make nested navigation menus.

## 1. Installation

**Install via composer**

```bash
composer require "gibbs/phile-sub-navigation:1.*"
```

**Install via git**

Clone this repository from the ```phile``` directory into 
```plugins/gibbs/phileSubNavigation```. E.g:

```bash
git clone git@github.com:Gibbs/phileSubNavigation.git plugins/gibbs/phileSubNavigation
```

**Manual Install**

Download and extract the contents into: ```plugins/gibbs/phileSubNavigation```

## 2. Plugin Activation

Activate the plugin in your ```config.php``` file:

```php
$config['plugins']['gibbs\\phileSubNavigation'] = array('active' => true);
```

## 3. Example Usage

To be flexible NO HTML is generated by this plugin - that is the responsibility 
of the template engine you are using.

An example menu using the default Twig engine, placed inside a theme:

~~~html
<!-- Twig Macro -->
{% macro sub_navigation(navigation) %}
	{% import _self as macros %}
	{% for item in navigation %}
		<li>
			<a href="{{ item.uri }}">{{ item.meta.title }}</a>
			{% if item.children %}
				<ul>
					{{ macros.sub_navigation(item.children) }}
				</ul>
			{% endif %}
		</li>
	{% endfor %}
{% endmacro %}

{% import _self as macros %}
<ul>{{ macros.sub_navigation(navigation) }}</ul>
~~~

A real example I am currently using:

~~~html
{% macro sub_navigation(navigation) %}
	{% import _self as macros %}
	{% for item in navigation %}
		
		<li class="item">
			<a href="{{ item.uri }}">

				{% if item.meta.menu %}
					{{ item.meta.menu }}
				{% else %}
					{{ item.meta.title }} 
				}
				{% endif %}

				{% if item.children|length %}
					<div class="ui label">{{ item.children|length }}</div>
				{% endif %}
			</a>
		{% if item.children %}
			<ul class="menu">
				{{ macros.sub_navigation(item.children) }}
			</ul>
		{% endif %}
		</li>
		
	{% endfor %}
{% endmacro %}

{% import _self as macros %}
<ul class="ui vertical menu">
	<li class="item"><a href="{{ base_url }}">Home</a></li>
	{{ macros.sub_navigation(navigation) }}
</ul>
~~~

An example array returned for the default installation:

~~~php
Array
(
    [sub] => Array
        (
            [children] => Array
                (
                    [page] => Array
                        (
                            [meta] => Phile\Model\Meta Object
                                (
                                    [data:protected] => Array
                                        (
                                            [title] => Sub Page
                                        )

                                )

                            [uri] => sub/page
                        )

                )

            [meta] => Phile\Model\Meta Object
                (
                    [data:protected] => Array
                        (
                            [title] => Sub Page Index
                        )

                )

            [uri] => sub
        )

)
~~~

To debug the plugin output set ```'print' => true``` inside the plugins ```config.php```
file.

## 4. Caching

Caching is enabled by default and relies on ```phile\\simpleFileDataPersistence```
to be enabled (it is by default).

To disable caching edit the plugins ```config.php``` file and set *cache* to 
*false*.
